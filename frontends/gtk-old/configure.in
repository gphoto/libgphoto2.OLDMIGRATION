dnl Process this file with autoconf to produce a configure script.

AC_INIT(configure.in)
AM_INIT_AUTOMAKE(gphoto2-gtk, 0.1)
AM_CONFIG_HEADER(config.h)

AC_ISC_POSIX
AC_PROG_CC
AM_PROG_CC_STDC
AC_HEADER_STDC

AM_PATH_GTK(1.2.0, ,
            AC_MSG_ERROR(Cannot find GTK: Is gtk-config in path?))

dnl Add the languages which your application supports here.
ALL_LINGUAS=""
AM_GNU_GETTEXT

dnl Set PACKAGE_LOCALE_DIR in config.h.
if test "x${prefix}" = "xNONE"; then
  AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${ac_default_prefix}/${DATADIRNAME}/locale")
else
  AC_DEFINE_UNQUOTED(PACKAGE_LOCALE_DIR, "${prefix}/${DATADIRNAME}/locale")
fi

dnl Check for gPhoto2 configuration
AC_PATH_PROG(GPHOTO_CONFIG,gphoto2-config)
if test -n "${GPHOTO_CONFIG}"; then
  CFLAGS="$CFLAGS `$GPHOTO_CONFIG --cflags`"
  LIBS="$LIBS `$GPHOTO_CONFIG --libs`"
else
  AC_MSG_ERROR([
***
*** gPhoto2 is required. Available from gPhoto's Sourceforge CVS.
*** Check http://www.gphoto.net/download.html for details
***])
  exit 1
fi

dnl Check for libgpio configuration
AC_PATH_PROG(LIBGPIO_CONFIG,gpio-config)
if test -n "${LIBGPIO_CONFIG}"; then
  CFLAGS="$CFLAGS `$LIBGPIO_CONFIG --cflags`"
  LIBS="$LIBS `$LIBGPIO_CONFIG --libs`"
else
  AC_MSG_ERROR([
***
*** libgpio is required. Available from gPhoto's Sourceforge CVS.
*** Check http://www.gphoto.net/download.html for details
***])
  exit 1
fi


dnl Check for gdk-pixbuf configuration
AC_PATH_PROG(GDK_PIXBUF_CONFIG,gdk-pixbuf-config)
if test -n "${GDK_PIXBUF_CONFIG}"; then
  CFLAGS="$CFLAGS `$GDK_PIXBUF_CONFIG --cflags`"
  LIBS="$LIBS `$GDK_PIXBUF_CONFIG --libs`"
else
  AC_MSG_ERROR([
***
*** gdk-pixbuf (and headers) is required. Available from GNOME CVS.
*** Check http://www.gnome.org for details
***])
  exit 1
fi

dnl Set PACKAGE_DATA_DIR in config.h.
if test "x${datadir}" = 'x${prefix}/share'; then
  if test "x${prefix}" = "xNONE"; then
    AC_DEFINE_UNQUOTED(PACKAGE_DATA_DIR, "${ac_default_prefix}/share/${PACKAGE}")
  else
    AC_DEFINE_UNQUOTED(PACKAGE_DATA_DIR, "${prefix}/share/${PACKAGE}")
  fi
else
  AC_DEFINE_UNQUOTED(PACKAGE_DATA_DIR, "${datadir}/${PACKAGE}")
fi

dnl Set PACKAGE_SOURCE_DIR in config.h.
packagesrcdir=`cd $srcdir && pwd`
AC_DEFINE_UNQUOTED(PACKAGE_SOURCE_DIR, "${packagesrcdir}")

dnl find the gphoto doc dir to display the AUTHORS file
gphoto2docdir=`gphoto2-config --prefix`
CFLAGS="$CFLAGS -DGPDOCDIR=\\\"$gphoto2docdir/doc/gphoto2\\\""

GPHOTO_EXPAND_DIR(DOCDIR, "${prefix}/doc/gphoto2_gtk")
AC_DEFINE_UNQUOTED(DOCDIR, "$DOCDIR")

dnl Use -Wall if we have gcc.
changequote(,)dnl
if test "x$GCC" = "xyes"; then
  case " $CFLAGS " in
  *[\ \	]-Wall[\ \	]*) ;;
  *) CFLAGS="$CFLAGS -Wall" ;;
  esac
fi
changequote([,])dnl

AC_OUTPUT([
Makefile
src/Makefile
intl/Makefile
po/Makefile.in
])
